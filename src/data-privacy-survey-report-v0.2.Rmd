---
title: "Data Privacy Survey"
subtitle: "Challenges and needs of privacy-related services for research at Utrecht University"
author:
- "Dorien Huijser"
- "Neha Moopen"
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: |
  In the second quarter of 2022, Utrecht University (UU) Research Data Management 
  Support (RDM Support) sent out a survey among all scientific personnel at UU: 
  the Data Privacy Survey. The aim of this survey was to investigate 1) How UU 
  researchers currently deal with personal data in research, 2) What challenges 
  they run into when handling personal data in research, and 3) How support at
  UU can improve their services concerning personal data in research. The 
  results show that most researchers know to take into account 
  privacy in their projects. However, there are vast differences in knowledge 
  on this topic, as well as confusion on topics such as data sharing, 
  anonymisation, and the administrative requirements surrounding privacy. Taken
  together, the survey shows that researchers could benefit from research support
  that is more visible in the organisation and more hands-on (i.e., advise that is
  immediately applicable instead of more general). Additionally, more awareness 
  of the most important privacy-related topics, and how to deal with them in 
  research seems desirable, both for newly employed and existing researchers.
  Finally, many researchers indicate to experience a high administrative burden 
  that is partly caused by privacy-related documentation before starting a 
  project. Finding a way to decrease this burden while still complying with 
  legal and policy regulations will likely help to increase compliance and 
  help researchers focus on performing high-quality research.
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding, output_dir = "../docs") })
output:
  html_document:
    toc: true
    toc_depth: 2
    number_sections: false
    toc_float: true
    theme: united
    highlight: tango
    code_folding: hide
    df_print: paged
    css: style.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```

# Introduction
Scientific research often includes some form of personal data. The amount of 
personal data that is processed in research is likely underestimated, as 
researchers may be unaware of what personal data are or whether they are being 
collected. With the implementation of the General Data Protection Regulation
(GDPR) in 2018, stricter legal requirements apply to handling personal data and 
its sharing and publication. In our own experience, the number and complexity of 
questions on handling personal data in scientific research at Utrecht University
(UU) is increasing. 

Our premise at <a href = "https://uu.nl/rdm" target = "_blank">Research Data 
Management Support</a> (RDM Support) is to assist researchers with any issues 
surrounding the management of their research data, including research data that 
contains personal data. To understand how we can best help researchers with 
their privacy-related questions and needs, we wanted to investigate:

1. To what extent are UU researchers aware of privacy legislation and practices?
2. What data privacy issues do UU researchers typically run into?
3. What support do UU researchers need to handle personal data?

To answer these questions, we set up an online survey and planned one-on-one 
meetings with a selection of UU researchers. This report describes our methods, 
results and the future steps that data support at UU can take to improve their 
services concerning privacy in research.

This survey was part of a larger project at UU, the <a href = "https://utrechtuniversity.github.io/dataprivacyproject/" 
target = "_blank">Data Privacy Project</a>^[The Data Privacy Project is funded 
by Utrecht Universityâ€™s Research IT program and a Digital Competence Center 
grant from the Dutch Organization for Scientific Research (NWO). It is led by Utrecht 
University's <a href="https://uu.nl/rdm/" target = "_blank">Research Data 
Management Support</a>, in collaboration with the University Library, 
Information Technology Services, first- and second-line privacy officers, 
information security, and others.]. This project is a data support effort within 
UU that aims to provide actionable and FAIR (Findable, Accessible, Interoperable, 
Reusable) information and tools for researchers to handle personal data in their 
research. 

# Methods
```{r dependencies, warning = FALSE, message = FALSE}
# install.packages("data.table")
library(data.table)

# install.packages("tidyverse")
library(tidyverse)

#install.packages("gridExtra")
library(gridExtra)

#install.packages("knitr")
library(knitr)

#install.packages("kableExtra")
library(kableExtra)
```

```{r readdata}
### Find the most recent data file in data/pseud or data/processed and read it in
# List all the files in pseud and processed folder
data_files_pseud <- list.files(path = "../data/pseud")
data_files_processed <- list.files(path = "../data/processed")

data_files <- data.frame(filename = c(data_files_pseud,
                                      data_files_processed),
                         folder = c(rep("pseud", length(data_files_pseud)),
                                    rep("processed", length(data_files_processed))
                                    )
                         )

# Get the dates out of the file names and pick the newest one
data_files$filenamedates <- as.Date(str_extract(pattern = "[0-9]+-[0-9]+-[0-9]+", 
                                     string = data_files$filename),
                         format = "%Y-%m-%d")

# Sort by date (descending = most recent one first)
setorder(data_files, -filenamedates)

# Get most recent file
datafile <- paste0("../data/",
                   data_files$folder[1],
                   "/",
                   data_files$filename[1])

dppsurvey <- fread(datafile)
```

## Survey questions 
The [Data Privacy Survey](#data-and-material-availability) was created by the project 
coordinators (DH, NM) with input from a wide variety of experts, consisting of 
privacy experts, data managers, data consultants, and IT staff (e.g., information 
security,  research engineering). The final version of the survey 
consisted of 19-23 questions (the exact number differing depending on given 
answers), which were separated into 5 sections:

1. **About you and your research**: 5 questions about the faculty, department, 
position, and type of (personal) data the researcher works with.
2. **Measures and documents**: 4-6 questions about researchers' familiarity and
use of privacy-related measures (e.g., processing register, Data Privacy Impact
Assessment, encryption, pseudonymisation, etc.), data storage, and informed 
consent forms.
3. **Data sharing, archiving and publication**: 3-4 questions about researchers' 
data sharing and publishing practices.
4. **Finding support**: 3-4 questions about the awareness of several data support
channels.
5. **Improving our services**: 4 questions about researchers' challenges, needs, 
and suggestions to improve UU's data privacy support.

The estimated 10 minute duration of the survey in advance proved to be 
relatively accurate: respondents spent a median of 
`r round(median(dppsurvey$Duration/60), 1)` minutes on the survey (although 
there was a very large variation; range: 
`r round(min(dppsurvey$Duration)/60, 1)` minutes - 
`r round(max(dppsurvey$Duration)/3600/24,1)` days).

## Procedure online survey
The survey was created in Qualtrics and distributed from March 21st, 2022 
onwards via several communication channels to reach as many UU researchers as 
possible:

- An <a href = "https://utrechtuniversity.github.io/dataprivacyproject/20220321-data-privacy-survey.html"
target = "_blank">email</a> was sent to all academic staff at UU through 
central communication channels. The reasoning was that this would be the most
effective way to reach as many UU researchers as possible - taking for granted
that we would likely miss a small part of non-academic personnel also involved
in research in some way.
- A mention in several Faculty newsletters.
- Social media messages (e.g., on <a href = "https://twitter.com/RDMsupportUU/status/1517390979707412481"
target = "_blank">Twitter</a>).
- A <a href = "https://intranet.uu.nl/en/news/news-items/survey-better-support-for-handling-privacy-sensitive-data-in-research" target = "_blank">news item</a> on the UU intranet.
- Via data support colleagues, who were asked to point researchers they were
in contact with to the survey.

Researchers could decide voluntarily whether they wanted to participate in the
survey. All results reported here are from researchers who provided their active 
consent, worked at Utrecht University and indicated to work with some type of 
research data.

## Online survey respondents
The survey was filled out by `r dim(dppsurvey)[1]` UU researchers. As can be 
seen in the figure below, we received responses from each UU faculty, but the 
distribution was not equal: the faculties of Science and Social and Behavioural 
Sciences were overrepresented, whereas the responses of the Faculty of 
Geosciences and the Faculty of Medicine were rather low. This can be explained 
by the mere size of the faculties (e.g., the faculty of Science is UU's largest 
faculty), but also by the types of research performed there. For example, 
research performed at the faculty of Geosciences is largely involved with 
natural scientific data, rather than data from or relating to humans. The 
Faculty of Medicine, then, is located at the University Medical Center Utrecht 
(UMCU) and is not of primary interest for the current survey, which was sent to 
UU researchers only. A small selection of respondents indicated to work at 
another part of the organisation, being mainly University College Utrecht and 
the University Corporate Office.

As can be seen in the figure below, most respondents were relatively early 
career researchers (PhDs, junior researchers and postdoctoral researchers). 
We suspect that this is because 1) there simply are more people in these positions
than there are in the others, and 2) early-career researchers may experience a 
greater need for support with respect to handling personal data.

```{r facultyplot, warning = FALSE, message = FALSE}
# R color brewers palettes: http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/
# UU colors: https://www.uu.nl/en/organisation/corporate-identity/brand-policy/colour
UU_pallette <- c(#"#FFCD00", # UU yellow
                 "#FFE6AB", # Lighter yellow
                 "#F3965E", # Orange
                 "#AA1555", # Bordeaux-red
                 "#6E3B23", # Brown
                 "#24A793", # Green
                 "#5287C6", # Blue
                 "#001240", # Dark blue
                 "#5B2182") # Purple

# Plot of positions per faculty
position_per_faculty <- dppsurvey %>%
  pivot_longer(cols = grep("Faculty_[0-9]$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Faculty") %>%
  select(-name) %>%
  pivot_longer(cols = grep("Position_[0-9]$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Position") %>%
  select(-name) %>%
  group_by(Faculty, Position) %>%
  summarise(Count = length(Faculty)) %>%
  ggplot(aes(reorder(Faculty, 
                     -Count, 
                     sum, 
                     decreasing = T), 
             Count, 
             fill = Position)) +
  coord_flip() +
  theme_classic() + 
  geom_col() +
  scale_fill_manual(values = UU_pallette) +
  labs(x = "", title = "Faculty and Position representation") +
  scale_y_discrete(expand = expansion(add = 4)) + # make field larger to see label
  #scale_x_continuous(expand = expansion(add = 3)) + 
  geom_label(aes(label = after_stat(y), group = Faculty), # totals per faculty
             stat = 'summary', 
             fun = sum, 
             vjust = 0.5, 
             hjust = -0.2, #"inward",
             nudge_y = 2,
             label.size = NA, #1,
             label.padding = unit(0.35, "lines"),
             #label.r = unit(0.25, "lines"),
             color = "black",
             fill = "#FFFFFF") + #"#FFCD00") +
  geom_text(aes(label = Count), # counts per position per faculty
            color = "white",
            fill = "#FFFFFF",
            position = position_stack(vjust = 0.5)) +
  theme(legend.text = element_text(size = 8),
        legend.position = "bottom",
        legend.title = element_blank(),
        axis.title.x = element_text(size = 11),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 11),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank()) +
  guides(fill = guide_legend(nrow = 3, byrow = FALSE))

position_per_faculty

```

## One-on-one meetings
Besides the online survey, we organised one-on-one meetings with researchers, to 
hear about their personal experiences, challenges and needs concerning the handling 
of personal data in their research. Survey respondents could voluntarily leave 
their email address at the end of the survey to be contacted by us. These 
meetings were semi-structured and revolved around the following questions:

- What made you leave your email address in the Data Privacy Survey? Related:
What are your general experiences in handling personal data in research?
- Which difficulties do you run into when handling personal data?
- What support would you need to help you handle personal data in your research?
- Do you have a concrete need for support at the moment?

 From the survey respondents, 
`r sum(dppsurvey$Email == "Yes", na.rm=TRUE)` researchers left their email 
address to be contacted. Of those, 28 researchers indicated that they were 
willing to meet with us. So far, 27 one-on-one online 
meetings have been conducted, each taking about 30 minutes. During the meetings,
one of the project coordinators (DH) was always present, together with either the
other project coordinator (NM) or the relevant faculty privacy officer. Before
the privacy officer was invited to the meeting, the researcher's consent to do 
so was always asked first.

Below, the division over faculties can be seen for all interviewees. For privacy
reasons, the positions of the interviewees are not displayed here. 

```{r emailaddressplot}
library(readxl)

# Read in coded responses from interviews
interviewfile <- "../data/coded/dppsurvey_interviews_coded.xlsx"
interviews <- read_excel(interviewfile, sheet = "interviews")

meetings_faculties <- data.frame(Faculty = str_trim(unlist(str_split(interviews$Faculty, 
                                                                     ",")), 
                                                    side = "both"))

emailsplot <-
  meetings_faculties %>%
  group_by(Faculty) %>%
  summarise(Count = length(Faculty)) %>%
  arrange(Count) %>% # Order by count
  mutate(Faculty = factor(Faculty, levels=Faculty)) %>% # Update factor levels
  ggplot(aes(x = Faculty, y = Count)) + 
  geom_bar(stat = "identity", fill = "#FFCD00") + 
  labs(x = "", title = "Faculty representation of researchers spoken to") +
  coord_flip() +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             vjust = 0.5, 
             hjust = -0.2, #"inward",
             label.size = NA, #1,
             label.padding = unit(0.35, "lines"),
             color = "black",
             fill = "#FFFFFF") + #"#FFCD00") +
  theme(axis.title.x = element_text(size = 11),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 11),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank())

emailsplot

# Code for donut chart - looks nice, but is horrible to actually interpret
#donutchart <-
#  meetings_faculties %>%
#  group_by(Faculty) %>%
#  summarise(Count = length(Faculty)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(Faculty = factor(Faculty, levels=Faculty)) %>% # Update factor levels
#  mutate(Fraction = (Count/sum(Count))) %>%
#  mutate(ymax = cumsum(Fraction)) %>%
#  mutate(ymin = c(0, head(ymax, n = -1))) %>%
#  mutate(labelPosition = (ymax + ymin)/2) %>%
#  mutate(label = paste0(Count)) %>%
#  ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = Faculty)) +
#  geom_rect() +
#  geom_label(x = 3.5,
#             aes(y = labelPosition, label = label),
#             size = 3,
#             fill = "white") + 
#  coord_polar(theta = "y") +
#  xlim(c(1, 4)) + 
#  scale_fill_manual(values = UU_pallette) +
#  theme_void()
#
#donutchart
```

## Analysis
From the raw Qualtrics output, we first cleaned and split the data into different
data files (cleaned and closed survey responses, open text responses, email
addresses, see the <a href="../src/pseudonymise-data.R" target="_blank">
pseudonymise-data.R</a> script for details). Both the open text responses and 
the notes made during the one-on-one meetings were separately and manually scored
to enable the extraction of action points. 

Below we report on the descriptive statistics or summaries from most of the 
survey questions. As we did not formulate hypotheses, no statistical analyses 
were performed. 

## Data and material availability
All survey-related documentation can be found in the <a href="https://github.com/UtrechtUniversity/dataprivacysurvey" 
target = "_blank">dedicated survey repository</a>. It contains:

- The 
<a href = "https://utrechtuniversity.github.io/dataprivacysurvey/assets/survey-questions-qualtrics.pdf"
target = "_blank">full survey</a>
- The survey's <a href = "https://utrechtuniversity.github.io/dataprivacysurvey/assets/survey-privacy-statement.pdf"target = "_blank">privacy statement</a>
- The <a href="https://github.com/UtrechtUniversity/dataprivacysurvey/tree/main/src" target = "_blank">
scripts used to clean the data and write this report</a>

As the dataset contains personal information (demographic information, open text 
responses, email addresses, etc.), and no consent was obtained to share those 
details, we are unable to share them in this repository.

# Results
## Types of research data {.tabset}
### University-wide

Between all survey respondents, it is clear that most researchers at UU have 
tabular, textual, code and audio data as their primary research data format. 
In terms of *personal* data types, contact information, demographic information 
and direct identifiers seem to be the most common among the respondents. This 
can be either because these are the types of personal data that are indeed most 
common, but possibly also because researchers mostly recognize these types of 
data as being personal data.

```{r datatypes, results = "asis"}
# Table of data types
datatypetable <- dppsurvey %>% 
  pivot_longer(cols = grep("^Datatype_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Datatype") %>%
  select(-name) %>%
  group_by(Datatype) %>%
  summarise(Count = length(Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Datatype = factor(Datatype, levels=Datatype)) %>% # Update factor levels
  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                           " (",
                           Percentage,
                           "%)"),
         ) %>%
  select(-Count, -Percentage)

# Table of personal data types
tablepersdata <- dppsurvey %>% 
  pivot_longer(cols = grep("^Personaldata_type_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Personal_Datatype") %>%
  select(-name) %>%
  group_by(Personal_Datatype) %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype), # Update factor levels
         Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                           " (",
                           Percentage,
                           "%)"),
         ) %>%
  select(-Count, -Percentage)

kables(list(
  kbl(datatypetable,
      col.names = gsub("_", 
                       " ", 
                       names(datatypetable)), 
      align = "l",
      caption = "<b>Types of data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F, 
                  html_font = "Verdana",
                  font_size = 12,
                  position = "float_left"),
  kbl(tablepersdata, 
      col.names = gsub("_", 
                       " ", 
                       names(tablepersdata)), 
      align = "l",
      caption = "<b>Types of <i>personal</i> data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F,
                  html_font = "Verdana",
                  font_size = 12,
                  position = "left")))
```

When comparing faculties, it appears that most personal data is processed in the
faculties of Social and Behavioural Sciences (FSBS), although the faculties of 
Science and Veterinary Medicine also seem to process quite some personal data.
In the tabs, we look further into the types of (personal) data processed within
each faculty.

```{r personaldataplot, warning = FALSE, message = FALSE}
# Graph
datatypegraphs <- dppsurvey %>% 
  pivot_longer(cols = grep("^Personaldata_type_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Personal_Datatype") %>%
  select(-name) %>%
  pivot_longer(cols = grep("^Faculty_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Faculty") %>%
  select(-name) %>%
  group_by(Faculty, Personal_Datatype) %>%
  summarise(Count = length(Personal_Datatype)) %>%
  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  arrange(Percentage) %>% # Order by percentage
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype)) %>% # Update factor levels
  ggplot(aes(x = Personal_Datatype, y = Percentage)) + 
  geom_bar(stat = "identity", fill = "#FFCD00") + 
  facet_wrap(~Faculty, ncol = 4,
             labeller = label_wrap_gen(width=14)) +
  labs(x = "", title = "Personal data types across Faculties (%)") +
  coord_flip() +
  theme_classic() +
  geom_text(aes(label = paste0(Percentage, "%")),
             #vjust = 0.5, 
             hjust = "inward", #-0.2, #"inward",
             color = "black") +
  theme(axis.title.x = element_text(size = 10),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 10),
        axis.ticks = element_blank(),
        #panel.background = element_rect(fill = NA, color = "black"),
        panel.background = element_blank(),
        panel.border=element_blank(), #rect(fill = NA),
        panel.spacing.y = unit(1, "lines"),
        panel.grid.major.y = element_line(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank(),
        strip.background = element_rect(color="white",
                                        size=1.5),
        strip.text = element_text(family = "Verdana",
                                  size = 10,
                                  face = "bold"))

datatypegraphs

```



### Science
As with the university-wide data, researchers from the Science faculty indicated
that they also most often used tabular data, textual data and code/theoretical 
models in their research. The same goes for the types of *personal* data: the
same top-3 types are used here as in the entire university (demographic 
information, contact information, direct identifiers). 

```{r beta-datatypes, results = "asis", warning = FALSE, message = FALSE}
# Table of data types
beta_datatypetable <- dppsurvey %>% 
  filter(!is.na(Faculty_5)) %>%
  pivot_longer(cols = grep("^Datatype_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Datatype") %>%
  select(-name) %>%
  group_by(Datatype) %>%
  summarise(Count = length(Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Datatype = factor(Datatype, levels=Datatype)) %>% # Update factor levels
  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)")) %>%
  select(-Count, -Percentage)

# Table of personal data types
beta_personaldatatypes <- dppsurvey %>%
  filter(!is.na(Faculty_5)) %>%
  pivot_longer(cols = grep("^Personaldata_type_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Personal_Datatype") %>%
  select(-name) %>%
  group_by(Personal_Datatype)

beta_tablepersdata <- beta_personaldatatypes %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype), # Update factor levels
         Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)"),
  ) %>%
  select(-Count, -Percentage)

kables(list(
  kbl(beta_datatypetable,
      col.names = gsub("_", 
                       " ", 
                       names(beta_datatypetable)), 
      align = "l",
      caption = "<b>Types of data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F, 
                  html_font = "Verdana",
                  font_size = 12,
                  position = "float_left"),
  kbl(beta_tablepersdata, 
      col.names = gsub("_", 
                       " ", 
                       names(beta_tablepersdata)), 
      align = "l",
      caption = "<b>Types of <i>personal</i> data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F,
                  html_font = "Verdana",
                  font_size = 12,
                  position = "left")))
```

As a large part of the researchers from the Science faculty indicate not to use
*any* personal data whatsoever in their research, it may be useful to 
investigate in which departments these researchers work. In the figure below,
the division of personal data types per Science department is plotted. As can be
expected, the departments of Biology, Physics and Mathematics do not seem to 
process much personal data, whereas in the Information and Computing Sciences
and Pharmaceutal Sciences departments, the most personal data is processed. This
makes sense considering the types of research performed in these departments.

```{r beta-personaldataplot, warning = FALSE, message = FALSE}

# Graph
beta_datatypegraphs <- beta_personaldatatypes %>%
  pivot_longer(cols = grep("^Dept_Science_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Department") %>%
  select(-name) %>%
  group_by(Department, Personal_Datatype) %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype)) %>% # Update factor levels
  ggplot(aes(x = Personal_Datatype, y = Count)) + 
  geom_bar(stat = "identity", fill = "#FFCD00") + 
  facet_wrap(~Department, ncol = 4,
             labeller = label_wrap_gen(width=14)) +
  labs(x = "", title = "Personal data types across Science departments") +
  coord_flip() +
  theme_classic() +
  geom_text(aes(label = Count),
             #vjust = 0.5, 
             hjust = "inward", #-0.2, #"inward",
             color = "black") +
  theme(axis.title.x = element_text(size = 10),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 10),
        axis.ticks = element_blank(),
        #panel.background = element_rect(fill = NA, color = "black"),
        panel.background = element_blank(),
        panel.border=element_blank(), #rect(fill = NA),
        panel.spacing.y = unit(1, "lines"),
        panel.grid.major.y = element_line(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank(),
        strip.background = element_rect(color="white",
                                        size=1.5),
        strip.text = element_text(family = "Verdana",
                                  size = 10,
                                  face = "bold"))

beta_datatypegraphs
```

### FSBS
As with the university-wide data, researchers from the faculty of Social and
Behavioural Sciences (FSBS) indicated that they also most often used tabular data, 
textual data and code/theoretical models in their research. The same goes for 
the types of *personal* data: demographic and contact information are most often
used. Interestingly, sensitive demographic information is used much more relative
to  the UU-wide responses.

```{r fsw-datatypes, results = "asis", warning = FALSE, message = FALSE}
# Table of data types
fsw_datatypetable <- dppsurvey %>% 
  filter(!is.na(Faculty_6)) %>%
  pivot_longer(cols = grep("^Datatype_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Datatype") %>%
  select(-name) %>%
  group_by(Datatype) %>%
  summarise(Count = length(Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Datatype = factor(Datatype, levels=Datatype)) %>% # Update factor levels
  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)")) %>%
  select(-Count, -Percentage)

# Table of personal data types
fsw_personaldatatypes <- dppsurvey %>%
  filter(!is.na(Faculty_6)) %>%
  pivot_longer(cols = grep("^Personaldata_type_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Personal_Datatype") %>%
  select(-name) %>%
  group_by(Personal_Datatype)

fsw_tablepersdata <- fsw_personaldatatypes %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype), # Update factor levels
         Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)"),
  ) %>%
  select(-Count, -Percentage)

kables(list(
  kbl(fsw_datatypetable,
      col.names = gsub("_", 
                       " ", 
                       names(fsw_datatypetable)), 
      align = "l",
      caption = "<b>Types of data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F, 
                  html_font = "Verdana",
                  font_size = 12,
                  position = "float_left"),
  kbl(fsw_tablepersdata, 
      col.names = gsub("_", 
                       " ", 
                       names(fsw_tablepersdata)), 
      align = "l",
      caption = "<b>Types of <i>personal</i> data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F,
                  html_font = "Verdana",
                  font_size = 12,
                  position = "left")))
```

When comparing the types of personal data across departments of the faculty, the
departments of Sociology and Cultural Anthropology seem to process the least
amount of personal data - although these departments may also simply be 
underrepresented in the survey sample. Most other departments process quite some
personal data, as can be expected from a faculty of which the research focuses
almost exclusively on humans. 

```{r fsw-personaldataplot, warning = FALSE, message = FALSE}
# Graph
fsw_datatypegraphs <- fsw_personaldatatypes %>%
  pivot_longer(cols = grep("^Dept_FSW_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Department") %>%
  select(-name) %>%
  group_by(Department, Personal_Datatype) %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype)) %>% # Update factor levels
  ggplot(aes(x = Personal_Datatype, y = Count)) + 
  geom_bar(stat = "identity", fill = "#FFCD00") + 
  facet_wrap(~Department, nrow = 3,
             labeller = label_wrap_gen(width=11)) +
  labs(x = "", title = "Personal data types across FSBS departments") +
  coord_flip() +
  theme_classic() +
  geom_text(aes(label = Count),
             #vjust = 0.5, 
             hjust = "inward", #-0.2, #"inward",
             color = "black") +
  theme(axis.title.x = element_text(size = 10),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 10),
        axis.ticks = element_blank(),
        #panel.background = element_rect(fill = NA, color = "black"),
        panel.background = element_blank(),
        panel.border=element_blank(), #rect(fill = NA),
        panel.spacing.y = unit(1, "lines"),
        panel.grid.major.y = element_line(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank(),
        strip.background = element_rect(color="white",
                                        size=1.5),
        strip.text = element_text(family = "Verdana",
                                  size = 10,
                                  face = "bold"))

fsw_datatypegraphs
```

### Humanities
As with the university-wide data, researchers from the faculty of Humanities 
indicated that they also most frequently used tabular data, textual data and 
audio data in their research. The same goes for the types of *personal* data: the
same top-3 types are present here as in the entire university (demographic 
information, contact information, direct identifiers). 

```{r hum-datatypes, results = "asis", warning = FALSE, message = FALSE}
# Table of data types
hum_datatypetable <- dppsurvey %>% 
  filter(!is.na(Faculty_2)) %>%
  pivot_longer(cols = grep("^Datatype_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Datatype") %>%
  select(-name) %>%
  group_by(Datatype) %>%
  summarise(Count = length(Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Datatype = factor(Datatype, levels=Datatype)) %>% # Update factor levels
  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)")) %>%
  select(-Count, -Percentage)

# Table of personal data types
hum_personaldatatypes <- dppsurvey %>%
  filter(!is.na(Faculty_2)) %>%
  pivot_longer(cols = grep("^Personaldata_type_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Personal_Datatype") %>%
  select(-name) %>%
  group_by(Personal_Datatype)

hum_tablepersdata <- hum_personaldatatypes %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype), # Update factor levels
         Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)"),
  ) %>%
  select(-Count, -Percentage)

kables(list(
  kbl(hum_datatypetable,
      col.names = gsub("_", 
                       " ", 
                       names(hum_datatypetable)), 
      align = "l",
      caption = "<b>Types of data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F, 
                  html_font = "Verdana",
                  font_size = 12,
                  position = "float_left"),
  kbl(hum_tablepersdata, 
      col.names = gsub("_", 
                       " ", 
                       names(hum_tablepersdata)), 
      align = "l",
      caption = "<b>Types of <i>personal</i> data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F,
                  html_font = "Verdana",
                  font_size = 12,
                  position = "left")))
```

If we look at the different departments within the faculty, it is clear that
mostly the departments of Languages, Literature and Communication, and of Media
and Culture Studies process personal data in their research. Especially 
researchers at the department of Languages, Literature and Communication seem to
process a lot of personal data, which makes sense considering the type of research
performed there.

```{r hum-personaldataplot, warning = FALSE, message = FALSE}
# Graph
hum_datatypegraphs <- hum_personaldatatypes %>%
  pivot_longer(cols = grep("^Dept_Humanities_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Department") %>%
  select(-name) %>%
  group_by(Department, Personal_Datatype) %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype)) %>% # Update factor levels
  ggplot(aes(x = Personal_Datatype, y = Count)) + 
  geom_bar(stat = "identity", fill = "#FFCD00") + 
  facet_wrap(~Department, ncol = 3,
             labeller = label_wrap_gen(width=14)) +
  labs(x = "", title = "Personal data types across Humanities departments") +
  coord_flip() +
  theme_classic() +
  geom_text(aes(label = Count),
             #vjust = 0.5, 
             hjust = "inward", #-0.2, #"inward",
             color = "black") +
  theme(axis.title.x = element_text(size = 10),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 10),
        axis.ticks = element_blank(),
        #panel.background = element_rect(fill = NA, color = "black"),
        panel.background = element_blank(),
        panel.border=element_blank(), #rect(fill = NA),
        panel.spacing.y = unit(1, "lines"),
        panel.grid.major.y = element_line(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank(),
        strip.background = element_rect(color="white",
                                        size=1.5),
        strip.text = element_text(family = "Verdana",
                                  size = 10,
                                  face = "bold"))

hum_datatypegraphs
```

### Veterinary Medicine

When comparing the types of data that researchers at the Faculty of Veterinary
Medicine work with, it is clear that researchers at this faculty work with 
slightly different types of data, i.e. biological and physiological data are 
more common among these researchers. Despite this, the most frequent types
of personal data do correspond well to  the university-wide numbers: 
demographic information, direct identifiers and contact information are also 
the most common types of personal data researchers at this faculty seem to 
deal with.

```{r dgk-datatypes, results = "asis", warning = FALSE, message = FALSE}
# Table of data types
dgk_datatypetable <- dppsurvey %>% 
  filter(!is.na(Faculty_7)) %>%
  pivot_longer(cols = grep("^Datatype_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Datatype") %>%
  select(-name) %>%
  group_by(Datatype) %>%
  summarise(Count = length(Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Datatype = factor(Datatype, levels=Datatype)) %>% # Update factor levels
  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)")) %>%
  select(-Count, -Percentage)

# Table of personal data types
dgk_personaldatatypes <- dppsurvey %>%
  filter(!is.na(Faculty_7)) %>%
  pivot_longer(cols = grep("^Personaldata_type_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Personal_Datatype") %>%
  select(-name) %>%
  group_by(Personal_Datatype)

dgk_tablepersdata <- dgk_personaldatatypes %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype), # Update factor levels
         Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)"),
  ) %>%
  select(-Count, -Percentage)

kables(list(
  kbl(dgk_datatypetable,
      col.names = gsub("_", 
                       " ", 
                       names(dgk_datatypetable)), 
      align = "l",
      caption = "<b>Types of data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F, 
                  html_font = "Verdana",
                  font_size = 12,
                  position = "float_left"),
  kbl(dgk_tablepersdata, 
      col.names = gsub("_", 
                       " ", 
                       names(dgk_tablepersdata)), 
      align = "l",
      caption = "<b>Types of <i>personal</i> data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F,
                  html_font = "Verdana",
                  font_size = 12,
                  position = "left")))
```

When looking at each department separately, it is clear that researchers in the
department of Population Health Sciences process the large majority of the 
personal data within the faculty. Of course, it may also be possible that this 
department was simply more represented in the survey than the other departments.

```{r dgk-personaldataplot, warning = FALSE, message = FALSE}
# Graph
dgk_datatypegraphs <- dgk_personaldatatypes %>%
  pivot_longer(cols = grep("^Dept_DGK_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Department") %>%
  select(-name) %>%
  group_by(Department, Personal_Datatype) %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype)) %>% # Update factor levels
  ggplot(aes(x = Personal_Datatype, y = Count)) + 
  geom_bar(stat = "identity", fill = "#FFCD00") + 
  facet_wrap(~Department, ncol = 3,
             labeller = label_wrap_gen(width=14)) +
  labs(x = "", title = "Personal data types across Veterinary Medicine") +
  coord_flip() +
  theme_classic() +
  geom_text(aes(label = Count),
             #vjust = 0.5, 
             hjust = "inward", #-0.2, #"inward",
             color = "black") +
  theme(axis.title.x = element_text(size = 10),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 10),
        axis.ticks = element_blank(),
        #panel.background = element_rect(fill = NA, color = "black"),
        panel.background = element_blank(),
        panel.border=element_blank(), #rect(fill = NA),
        panel.spacing.y = unit(1, "lines"),
        panel.grid.major.y = element_line(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank(),
        strip.background = element_rect(color="white",
                                        size=1.5),
        strip.text = element_text(family = "Verdana",
                                  size = 10,
                                  face = "bold"))

dgk_datatypegraphs
```

### LEG
As with the university-wide data, researchers from the faculty of Law, 
Economics and Governance (LEG) indicated that they also most frequently used 
tabular data, textual data and audio data in their research. The same goes for 
the types of *personal* data: the same top-3 types are present here as in the 
entire university (demographic information, contact information, 
direct identifiers). 

```{r leg-datatypes, results = "asis", warning = FALSE, message = FALSE}
# Table of data types
leg_datatypetable <- dppsurvey %>% 
  filter(!is.na(Faculty_3)) %>%
  pivot_longer(cols = grep("^Datatype_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Datatype") %>%
  select(-name) %>%
  group_by(Datatype) %>%
  summarise(Count = length(Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Datatype = factor(Datatype, levels=Datatype)) %>% # Update factor levels
  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)")) %>%
  select(-Count, -Percentage)

# Table of personal data types
leg_personaldatatypes <- dppsurvey %>%
  filter(!is.na(Faculty_3)) %>%
  pivot_longer(cols = grep("^Personaldata_type_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Personal_Datatype") %>%
  select(-name) %>%
  group_by(Personal_Datatype)

leg_tablepersdata <- leg_personaldatatypes %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype), # Update factor levels
         Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)"),
  ) %>%
  select(-Count, -Percentage)

kables(list(
  kbl(leg_datatypetable,
      col.names = gsub("_", 
                       " ", 
                       names(leg_datatypetable)), 
      align = "l",
      caption = "<b>Types of data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F, 
                  html_font = "Verdana",
                  font_size = 12,
                  position = "float_left"),
  kbl(leg_tablepersdata, 
      col.names = gsub("_", 
                       " ", 
                       names(leg_tablepersdata)), 
      align = "l",
      caption = "<b>Types of <i>personal</i> data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F,
                  html_font = "Verdana",
                  font_size = 12,
                  position = "left")))
```

When looking at the different departments within the faculty, researchers in 
the department of Governance seem to process personal data the most often, 
followed by the department of Law. Of course, it is possible that the other 
departments process more personal data than the respondents indicated. 

```{r leg-personaldataplot, warning = FALSE, message = FALSE}
# Graph
leg_datatypegraphs <- leg_personaldatatypes %>%
  pivot_longer(cols = grep("^Dept_REBO_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Department") %>%
  select(-name) %>%
  group_by(Department, Personal_Datatype) %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype)) %>% # Update factor levels
  ggplot(aes(x = Personal_Datatype, y = Count)) + 
  geom_bar(stat = "identity", fill = "#FFCD00") + 
  facet_wrap(~Department, ncol = 3,
             labeller = label_wrap_gen(width=14)) +
  labs(x = "", title = "Personal data types across LEG departments") +
  coord_flip() +
  theme_classic() +
  geom_text(aes(label = Count),
             #vjust = 0.5, 
             hjust = "inward", #-0.2, #"inward",
             color = "black") +
  theme(axis.title.x = element_text(size = 10),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 10),
        axis.ticks = element_blank(),
        #panel.background = element_rect(fill = NA, color = "black"),
        panel.background = element_blank(),
        panel.border=element_blank(), #rect(fill = NA),
        panel.spacing.y = unit(1, "lines"),
        panel.grid.major.y = element_line(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank(),
        strip.background = element_rect(color="white",
                                        size=1.5),
        strip.text = element_text(family = "Verdana",
                                  size = 10,
                                  face = "bold"))

leg_datatypegraphs
```

### Geo

As with the university-wide data, researchers from the faculty of Geosciences
indicated that they also most frequently used textual and tabular data. However,
in contrast to the university-wide data, they are followed by geographical data
and code/theoretical models. This is to be expected considering the faculty. In 
terms of *personal* data, however, the same top-3 types are present here as in the 
entire university (demographic information, contact information, 
direct identifiers). 

```{r geo-datatypes, results = "asis", warning = FALSE, message = FALSE}
# Table of data types
geo_datatypetable <- dppsurvey %>% 
  filter(!is.na(Faculty_1)) %>%
  pivot_longer(cols = grep("^Datatype_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Datatype") %>%
  select(-name) %>%
  group_by(Datatype) %>%
  summarise(Count = length(Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Datatype = factor(Datatype, levels=Datatype)) %>% # Update factor levels
  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)")) %>%
  select(-Count, -Percentage)

# Table of personal data types
geo_personaldatatypes <- dppsurvey %>%
  filter(!is.na(Faculty_1)) %>%
  pivot_longer(cols = grep("^Personaldata_type_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Personal_Datatype") %>%
  select(-name) %>%
  group_by(Personal_Datatype)

geo_tablepersdata <- geo_personaldatatypes %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype), # Update factor levels
         Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) %>% # reverse order
  mutate(Frequency = paste0(Count, 
                            " (",
                            Percentage,
                            "%)"),
  ) %>%
  select(-Count, -Percentage)

kables(list(
  kbl(geo_datatypetable,
      col.names = gsub("_", 
                       " ", 
                       names(geo_datatypetable)), 
      align = "l",
      caption = "<b>Types of data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F, 
                  html_font = "Verdana",
                  font_size = 12,
                  position = "float_left"),
  kbl(geo_tablepersdata, 
      col.names = gsub("_", 
                       " ", 
                       names(geo_tablepersdata)), 
      align = "l",
      caption = "<b>Types of <i>personal</i> data used</b>",
      valign = 't') %>%
    kable_classic(latex_options = "hover",
                  full_width = F,
                  html_font = "Verdana",
                  font_size = 12,
                  position = "left")))
```

When comparing departments, it becomes immediately clear that most personal
data seems to be processed in the department of Sustainable Development, and
some also in the Human Geography and Spatial Planning department. This makes 
sense, as the research performed at the third department (Earth sciences) usually
does not focus on human behaviour and thus does not involve much personal data, 
if any. 

```{r geo-personaldataplot, warning = FALSE, message = FALSE}
# Graph
geo_datatypegraphs <- geo_personaldatatypes %>%
  pivot_longer(cols = grep("^Dept_Geo_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Department") %>%
  select(-name) %>%
  group_by(Department, Personal_Datatype) %>%
  summarise(Count = length(Personal_Datatype)) %>%
  arrange(Count) %>% # Order by count
  mutate(Personal_Datatype = factor(Personal_Datatype, levels=Personal_Datatype)) %>% # Update factor levels
  ggplot(aes(x = Personal_Datatype, y = Count)) + 
  geom_bar(stat = "identity", fill = "#FFCD00") + 
  facet_wrap(~Department, ncol = 3,
             labeller = label_wrap_gen(width=14)) +
  labs(x = "", title = "Personal data types across the Geosciences faculty") +
  coord_flip() +
  theme_classic() +
  geom_text(aes(label = Count),
             #vjust = 0.5, 
             hjust = "inward", #-0.2, #"inward",
             color = "black") +
  theme(axis.title.x = element_text(size = 10),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 10),
        axis.ticks = element_blank(),
        #panel.background = element_rect(fill = NA, color = "black"),
        panel.background = element_blank(),
        panel.border=element_blank(), #rect(fill = NA),
        panel.spacing.y = unit(1, "lines"),
        panel.grid.major.y = element_line(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank(),
        strip.background = element_rect(color="white",
                                        size=1.5),
        strip.text = element_text(family = "Verdana",
                                  size = 10,
                                  face = "bold"))

geo_datatypegraphs
```

## {-}

## Current practices in handling personal data

The first part of the survey addressed the researchers' current practices in 
handling personal data in their research.

### Organisational and technical measures {.tabset}
#### University-wide results
With respect to organisational and technical measures used to handle personal 
data, most respondents indicated that they pseudonymise/anonymise their data. 
As this question is self-reported, we cannot assess whether the researchers' data 
was actually sufficiently pseudonymised/anonymised in line with the GDPR. 
Secondly, many researchers seemed to implement access control and encryption, 
and complete a Data Management Plan (DMP) during their project(s). This is to
be expected, as most funders nowadays require a DMP and many DMP templates 
explicitly address topics like pseudonymisation, access control and encryption. 
On the other hand, GDPR-specific assessments such as DPIAs or privacy reviews 
were least used - as it stands, these assessments are still only carried out on 
a case-by-case basis.
 
```{r measuresused, warning=FALSE, message=FALSE}
measures_plot <- 
  dppsurvey %>% 
  pivot_longer(cols = grep("Faculty_[0-9]$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Faculty") %>%
  select(-name) %>%
  pivot_longer(cols = grep("^Orgmeasures_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Measures") %>%
  select(-name) %>%
  group_by(Measures, Faculty) %>%
  summarise(Count = length(Measures)) %>%
  arrange(Count) %>% # Order by count
  #mutate(Measures = factor(Measures, levels=Measures)) %>% # Update factor levels
  ggplot(aes(reorder(Measures, 
                     -Count, 
                     sum, 
                     decreasing = T), 
             Count, 
             fill = Faculty)) +
  geom_bar(stat = "identity", fill = "#FFCD00") + 
  labs(x = "", title = "Protective and planning measures",
       caption = "Organisational and technical measures used in handling personal data") +
  coord_flip() +
  theme_classic() +
  geom_col() +
  scale_fill_manual(values = UU_pallette) +
  scale_y_discrete(expand = expansion(add = 4)) + # make field larger to see label
  geom_label(aes(label = after_stat(y), group = Measures),
             stat = 'summary',
             fun = sum,
             vjust = 0.5, 
             hjust = -0.2, #"inward",
             label.size = NA, #1,
             nudge_y = 2,
             label.padding = unit(0.35, "lines"),
             color = "black",
             fill = "#FFFFFF") + #"#FFCD00") +
  geom_text(aes(label = Count), # counts per measure per faculty
            color = "white",
            fill = "#FFFFFF",
            position = position_stack(vjust = 0.5)) +
  theme(legend.text = element_text(size = 8),
        legend.position = "bottom",
        legend.title = element_blank(),
        axis.title.x = element_text(size = 11),
        axis.line = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 11),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.border=element_blank(),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        plot.background=element_blank()) +
  guides(fill = guide_legend(nrow = 3, byrow = FALSE))

measures_plot
```


#### Science
Here are results per faculty

#### FBSB
dasd

#### Humanities
asasd

#### Veterinary Medicine
adasds

#### LEG
asasd

#### Geo
asd

### {-}

### Storage media used {.tabset}
#### University-wide results
To store personal data, most researchers rely on storage solutions provided by UU. Nonetheless, some researchers utilize non-UU solutions, including non-UU cloud storage. Several researchers also indicated they use 'Other' storage solutions. Examples of these include external
institutions (e.g., University Medical Center, Trimbos Institute, Central Bureau of Statistics) and external repositories (e.g., DANS EASY, CLARIAH).


```{r storagemediaplot}
storage_used_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^Storage_medium_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Storage") %>%
  select(-name) %>%
  group_by(Storage) %>%
  summarise(Count = length(Storage)) %>%
  arrange(Count) %>% # Order by count
  mutate(Storage = factor(Storage, levels=Storage)) %>% # Update factor levels
  ggplot(aes(x = Storage, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Storage media used",
       caption = "Storage Media Used for Storing Personal Data") +
  coord_flip() +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

  print(storage_used_plot)
```

```{r storagemedia}
# table storage media used
#storage_used_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^Storage_medium_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "Storage") %>%
#  select(-name) %>%
#  group_by(Storage) %>%
#  summarise(Count = length(Storage)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(Storage = factor(Storage, levels=Storage)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()
```

#### Faculty-specific results
Here are some specific results

### {-}

### Consent forms: usage and content {.tabset}
#### University-wide results
Only a small number of researchers indicate that consent forms are not applicable to their research or they don't know what they are. When researchers do use consent forms, they often use forms approved by privacy officers or ethical committees. Researchers however also indicate they tend to independently create and use forms. Departmental and UU-wide templates are also used to a fair extent. Some researchers ("Other") indicate to use templates from external institutions, or no templates at all (e.g., because they use verbal consent or data from another party).

Within the consent forms, most researchers provide information on the purposes for data collection and which data will be be used. Information on the data subject's rights and safeguards are included as well. Information on data sharing and reuse is presented sometimes, but not as consistently as the aforementioned topics. 

Most researchers indicate that 'regular' consent is explicitly requested, but consent to data sharing and further use is not always requested. This is a point of concern, because it may not be sufficient to merely inform data subjects that their data may be shared or reused, but data subjects should explicitly provide permission for their data to be used beyond the research project they signed on to. 

Lastly, contact details of the DPO are not always included, whereas these always have to be provided (<a href = "https://gdpr-info.eu/art-13-gdpr/" target = "_blank">art. 13</a>)

```{r consentforms}
consent_usage_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^Consentforms_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Consent_Forms") %>%
  select(-name) %>%
  group_by(Consent_Forms) %>%
  summarise(Count = length(Consent_Forms)) %>%
  arrange(Count) %>% # Order by count
  mutate(Consent_Forms = factor(Consent_Forms, levels=Consent_Forms)) %>% # Update factor levels
  ggplot(aes(x = Consent_Forms, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Consent Forms",
       caption = "Consent Forms: Usage") +
  coord_flip() +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

#print(consent_usage_plot)

# table of consent forms used
#consent_usage_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^Consentforms_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "Consent_Forms") %>%
#  select(-name) %>%
#  group_by(Consent_Forms) %>%
#  summarise(Count = length(Consent_Forms)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(Consent_Forms = factor(Consent_Forms, levels=Consent_Forms)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()

consent_content_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^Consent_content_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "Consent_Content") %>%
  select(-name) %>%
  group_by(Consent_Content) %>%
  summarise(Count = length(Consent_Content)) %>%
  arrange(Count) %>% # Order by count
  mutate(Consent_Content = factor(Consent_Content, levels=Consent_Content)) %>% # Update factor levels
  ggplot(aes(x = Consent_Content, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Form Content",
       caption = "Consent Forms: Content") +
  coord_flip() +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

#print(consent_content_plot)
grid.arrange(consent_usage_plot, consent_content_plot, nrow = 1)

# table of content in consent forms
#consent_content_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^Consent_content_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "Consent_Content") %>%
#  select(-name) %>%
#  group_by(Consent_Content) %>%
#  summarise(Count = length(Consent_Content)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(Consent_Content = factor(Consent_Content, levels=Consent_Content)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()
```

#### Faculty-specific results
Here are some specific results

### {-}

### Data Protection Impact Assessment (DPIA) {.tabset}
#### University-wide results
Most of the researchers who responded to the survey indicate that they have never carried out a DPIA, nor had they ever heard of it. A small number of researchers have heard of DPIAs, but have not completed one. A similar number researchers indicated that they are familiar with and have completed a Data Protection Impact Assessment (DPIA). Most of these researchers received help from a Privacy Officer with their DPIAs and few received help from either RDM Support or Legal Affairs. Some researchers indicated they received 'Other' help or none at all.

```{r dpia}
DPIA_experience_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^DPIA_experience_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "DPIA_experience") %>%
  select(-name) %>%
  group_by(DPIA_experience) %>%
  summarise(Count = length(DPIA_experience)) %>%
  arrange(Count) %>% # Order by count
  mutate(DPIA_experience = factor(DPIA_experience, levels=DPIA_experience)) %>% # Update factor levels
  ggplot(aes(x = DPIA_experience, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "DPIA Experience",
       caption = "Familiarity and experience with DPIAs") +
  coord_flip() +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

#print(DPIA_experience_plot)

# table  on experience with DPIAs
#DPIA_experience_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^DPIA_experience_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "DPIA_experience") %>%
#  select(-name) %>%
#  group_by(DPIA_experience) %>%
#  summarise(Count = length(DPIA_experience)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(DPIA_experience = factor(DPIA_experience, levels=DPIA_experience)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()

DPIA_help_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^DPIA_Help_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "DPIA_help") %>%
  select(-name) %>%
  group_by(DPIA_help) %>%
  summarise(Count = length(DPIA_help)) %>%
  arrange(Count) %>% # Order by count
  mutate(DPIA_help = factor(DPIA_help, levels=DPIA_help)) %>% # Update factor levels
  ggplot(aes(x = DPIA_help, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "DPIA Help",
       caption = "Help received with DPIAs") +
  coord_flip() +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

#print(DPIA_help_plot)
grid.arrange(DPIA_experience_plot, DPIA_help_plot, nrow = 1)

# table on help with DPIAs
#DPIA_help_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^DPIA_Help_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "DPIA_help") %>%
#  select(-name) %>%
#  group_by(DPIA_help) %>%
#  summarise(Count = length(DPIA_help)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(DPIA_help = factor(DPIA_help, levels=DPIA_help)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()
```

#### Faculty-specific results
Blabla

### {-}

### Data sharing practices {.tabset}
#### University-wide results
While there are some researchers who don't share their data at all, most researchers who responded to the survey indicate they do not share data with external parties, but only within the UU. A smaller number of researchers indicated they share data within the EEA. Responses in the "Other" category however suggest that a lot of data actually is shared, for example with co-authors at another institution, students, or in "pseudonymised form". There are researchers who share data outside the EEA, most of these with countries deemed to have an adequate level of protection according the GDPR. Only a few share with countries without an adequate level of protection.

Most researchers pseudonimise their data before sharing with external parties, though we cannot assess if this pseudonymisation is sufficient. Researchers also make use of approved tools, data transfer agreements, data processing agreements, and providing access without transfering the data. Fewer researchers indicate that they involved a Privacy Officer or Data Manager while transferring data, and the use of Standard Contractual Clauses appears limited.

```{r datasharing}
external_sharing_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^Share_outside_UU_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "external_sharing") %>%
  select(-name) %>%
  group_by(external_sharing) %>%
  summarise(Count = length(external_sharing)) %>%
  arrange(Count) %>% # Order by count
  mutate(external_sharing = factor(external_sharing, levels=external_sharing)) %>% # Update factor levels
  ggplot(aes(x = external_sharing, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "External Sharing",
       caption = "Data Sharing with External Parties") +
  coord_flip() +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

#print(external_sharing_plot)

#external_sharing_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^Share_outside_UU_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "external_sharing") %>%
#  select(-name) %>%
# group_by(external_sharing) %>%
#  summarise(Count = length(external_sharing)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(external_sharing = factor(external_sharing, levels=external_sharing)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()

sharing_measures_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^Share_measures_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "sharing_measures") %>%
  select(-name) %>%
  group_by(sharing_measures) %>%
  summarise(Count = length(sharing_measures)) %>%
  arrange(Count) %>% # Order by count
  mutate(sharing_measures = factor(sharing_measures, levels=sharing_measures)) %>% # Update factor levels
  ggplot(aes(x = sharing_measures, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Sharing Measures",
       caption = "Protection measures taken while sharing data") +
  coord_flip() +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

#print(sharing_measures_plot)

grid.arrange(external_sharing_plot, sharing_measures_plot, nrow = 1)

#sharing_measures_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^Share_measures_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "sharing_measures") %>%
#  select(-name) %>%
#  group_by(sharing_measures) %>%
#  summarise(Count = length(sharing_measures)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(sharing_measures = factor(sharing_measures, levels=sharing_measures)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()
```

#### Faculty-specific
Blabla

### {-}

### Data publishing {.tabset}
#### University-wide

```{r datapublishing}
data_publishing_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^Data_publication_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "data_publishing") %>%
  select(-name) %>%
  group_by(data_publishing) %>%
  summarise(Count = length(data_publishing)) %>%
  arrange(Count) %>% # Order by count
  mutate(data_publishing = factor(data_publishing, levels=data_publishing)) %>% # Update factor levels
  ggplot(aes(x = data_publishing, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Data Publishing",
       caption = "Data Publishing: Frequency and Content") +
  aes(stringr::str_wrap(data_publishing, 15), Count) + xlab(NULL) +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

print(data_publishing_plot)

#data_publishing_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^Data_publication_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "data_publishing") %>%
#  select(-name) %>%
#  group_by(data_publishing) %>%
#  summarise(Count = length(data_publishing)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(data_publishing = factor(data_publishing, levels=data_publishing)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()
```

The majority of researchers who responded to the survey indicate that they do not publish their data in any way or form. The primary reason for not publishing data appears to be that researchers are still working on the data. Nonetheless, many researchers indicate that they don't want to/need to publish their data, or they cannot anonymise the data. Other reasons include a lack of legal basis, not knowing if they're allowed to publish the data, too much effort, publication is undesirable, or just not considered. Finally, only a few researchers indicate that they don't know how to publish data at all

If a publication is made, most researchers tend to publish the metadata only while fewer publish the entire data set. Researchers tend to publish anonymous data primarily, followed by pseudonymised data. As with previous responses, it is not possible to assess whether this anonymisation or pseudonymisation was adequate.

```{r publicationformat}
publication_format_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^Publication_format_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "publication_format") %>%
  select(-name) %>%
  group_by(publication_format) %>%
  summarise(Count = length(publication_format)) %>%
  arrange(Count) %>% # Order by count
  mutate(publication_format = factor(publication_format, levels=publication_format)) %>% # Update factor levels
  ggplot(aes(x = publication_format, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Published Data Format",
       caption = "Format of Published Data") +
  aes(stringr::str_wrap(publication_format, 15), Count) + xlab(NULL) +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

#print(publication_format_plot)

# publication format table
#publication_format_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^Publication_format_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "publication_format") %>%
#  select(-name) %>%
#  group_by(publication_format) %>%
#  summarise(Count = length(publication_format)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(publication_format = factor(publication_format, levels=publication_format)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()

reasons_nopub_plot <- dppsurvey %>% 
  pivot_longer(cols = grep("^Reason_NoPub_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "reasons_nopub") %>%
  select(-name) %>%
  group_by(reasons_nopub) %>%
  summarise(Count = length(reasons_nopub)) %>%
  arrange(Count) %>% # Order by count
  mutate(reasons_nopub = factor(reasons_nopub, levels=reasons_nopub)) %>% # Update factor levels
  ggplot(aes(x = reasons_nopub, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Why Not Published?",
       caption = "Reasons for Not Publishing Data") +
  coord_flip() +
  theme_classic() +
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

#print(reasons_nopub_plot)
grid.arrange(publication_format_plot, reasons_nopub_plot, nrow = 1)

# reasons for not publishing table
#reasons_nopub_table <- dppsurvey %>% 
#  pivot_longer(cols = grep("^Reason_NoPub_[0-9]+$", names(dppsurvey), value=TRUE), 
#               values_drop_na = TRUE,
#               values_to = "reasons_nopub") %>%
#  select(-name) %>%
#  group_by(reasons_nopub) %>%
#  summarise(Count = length(reasons_nopub)) %>%
#  arrange(Count) %>% # Order by count
#  mutate(reasons_nopub = factor(reasons_nopub, levels=reasons_nopub)) %>% # Update factor levels
#  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
#  map_df(rev) %>% # reverse order
#  print()
```

#### Faculty
asdfasdf

### {-}

## Existing support channels
The second part of the survey concerned the visibility and use of existing 
support channels. 

### Faculty privacy officer {.tabset}
#### University-wide
When asked whether respondents know who their faculty
privacy officer is, most respondents indicated that they do 
not (Yes: `r sum(dppsurvey$Know_PO=="Yes", na.rm=TRUE)` 
(`r round(sum(dppsurvey$Know_PO=="Yes", na.rm=TRUE)/dim(dppsurvey)[1]*100,0)`%), No: 
`r sum(dppsurvey$Know_PO=="No", na.rm=TRUE)` 
(`r round(sum(dppsurvey$Know_PO=="Yes", na.rm=TRUE)/dim(dppsurvey)[1]*100,0)`%), NA: 
`r sum(is.na(dppsurvey$Know_PO))` 
(`r round(sum(is.na(dppsurvey$Know_PO))/dim(dppsurvey)[1]*100,0)`%)). This 
suggests either that researchers have simply never required help from their privacy 
officer, or that the faculty privacy officers could increase their visibility
within their faculties.

#### Faculty-specific
important info for faculty POs: how visible are they?

### {-}

### Looking for help {.tabset}
#### University-wide
When asked whether respondents have ever looked for support in the form of 
information, tools, or support an overwheling majority indicated that they have,
as can be seen in the graph below. Most respondents that looked for support
indicate however that they haven't always found the suport they were looking for.
Together with the results from the previous question about privacy officers,
this suggests that the visibility of the current support channels could be 
improved.

```{r existingsupport}
# Ever looked for help with privacy?
lookedforhelpplot <- dppsurvey %>% 
  pivot_longer(cols = Lookedforhelp, 
               values_drop_na = TRUE,
               values_to = "searchhelp") %>%
  select(-name) %>%
  group_by(searchhelp) %>%
  summarise(Count = length(searchhelp)) %>%
  arrange(Count) %>% # Order by count
  mutate(searchhelp = factor(searchhelp, levels = searchhelp)) %>% # Update factor levels
  ggplot(aes(x = searchhelp, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Has looked for help",
       caption = "Have you ever looked for UU-specific information, \n in-person support or tools on handling personal data?") +
  theme_classic() + 
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

# Found what you're looking for?
foundhelpplot <- dppsurvey %>% 
  pivot_longer(cols = Foundhelp, 
               values_drop_na = TRUE,
               values_to = "foundhelp") %>%
  select(-name) %>%
  group_by(foundhelp) %>%
  summarise(Count = length(foundhelp)) %>%
  arrange(Count) %>% # Order by count
  mutate(foundhelp = factor(foundhelp, levels = c("(Almost) always", 
                                                  "Often",
                                                  "Sometimes",
                                                  "(Almost) never"))) %>% # Update factor levels
  ggplot(aes(x = foundhelp, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Has found what they were looking for",
       caption = "Did you find what you were looking for \n(e.g., information, support, tools)?") +
  theme_classic() + 
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

grid.arrange(lookedforhelpplot, foundhelpplot, nrow = 1)
```

#### Faculty-specific
Hello world

### {-}

### Channels used to find support {.tabset}
#### University-wide
The graph below indicates which channels respondents to the survey used most 
when looking for information about handling personal data. Note that this was 
a multiple choice question, and so the numbers do no add up to the total number
of survey respondents. As shown below, all sources mentioned are to some extent
consulted by the respondents. However, there is large differentiation between 
these sources. The university website and intranet are the most visited online 
resources for information about handline personal data. Notably, colleagues 
appear to play an important role as well in informing researchers
about how to handle personal data.

```{r sourcesused}
# Sources used to find information and help
sourcesusedplot <- dppsurvey %>% 
  pivot_longer(cols = grep("^Sourcesused_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "sourcesused") %>%
  select(-name) %>%
  group_by(sourcesused) %>%
  summarise(Count = length(sourcesused)) %>%
  arrange(Count) %>% # Order by count
  mutate(sourcesused = factor(sourcesused, levels = sourcesused)) %>% # Update factor levels
  ggplot(aes(x = sourcesused, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Sources used to find help") +
  coord_flip() +
  theme_classic() + 
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

sourcesusedplot

# Other sources used
#sourcesusedother <- 
#  dppsurvey$Sourcesused_19_TEXT[!is.na(dppsurvey$Sourcesused_19_TEXT)] %>%
#  unlist() %>%
#  str_trim() %>%
#  str_to_lower()
```

#### Faculty

### {-}

## Challenges and needs (survey) {.tabset}
### University-wide

```{r obstacle}
obstacleplot <- dppsurvey %>% 
  pivot_longer(cols = Obstacle, 
               values_drop_na = TRUE,
               values_to = "obstacle") %>%
  select(-name) %>%
  group_by(obstacle) %>%
  summarise(Count = length(obstacle)) %>%
  arrange(Count) %>% # Order by count
  mutate(obstacle = factor(obstacle, levels = c("(Almost) always",
                                                "Sometimes",
                                                "(Almost) never",
                                                "Not sure"))) %>% # Update factor levels
  ggplot(aes(x = obstacle, y = Count)) + 
  geom_bar(stat = "identity") + 
  labs(x = "", title = "Is privacy an obstacle?",
       caption = "Do you see dealing with personal data as an obstacle in open science and research data management?") +
  theme_classic() + 
  geom_label(aes(label = Count), position=position_dodge(width=1.2),
             color = "black",
             fill = "#FFCD00")

obstacleplot
```

As can be seen above, most researchers experience privacy an obstacle for 
open science and research data management. It is therefore important to aim for
better service and support in this area. What this support should look like 
differs a bit: 

```{r bettersupport}
bettersupporttable <- dppsurvey %>% 
  pivot_longer(cols = grep("^Better_support_[0-9]+$", names(dppsurvey), value=TRUE), 
               values_drop_na = TRUE,
               values_to = "bettersupport") %>%
  select(-name) %>%
  group_by(bettersupport) %>%
  summarise(Count = length(bettersupport)) %>%
  arrange(Count) %>% # Order by count
  mutate(bettersupport = factor(bettersupport, levels=bettersupport)) %>% # Update factor levels
  mutate(Percentage = round(Count/dim(dppsurvey)[1]*100,1)) %>%
  map_df(rev) #%>% # reverse order
  #print()

 kable(bettersupporttable, 
        col.names = gsub("_", " ", names(bettersupporttable)), 
        align = "l",
        caption = "How can we improve personal data-related services?")
```

The open text responses reveal the following challenges and needs:

- **Knowledge gaps**: A selection of researchers use the space in the open questions to ask knowledge-related questions, such as: "How far should one go before data can be considered fully anonymous?" (n = 5), "What counts as personal data?" (n = 7), "How to make sure data are fully deleted?" (n = 1), and "What to do when only a selection of data subjects has consented to data sharing?" (n = 1). These questions can be addressed in future support efforts, such as to be developed information materials and trainings.
- **Time-intensive and bureaucratic**: Processes are often experienced as being time-inefficient, and sometimes longer and more bureaucratic than necessary. Some researchers argue that (part of) this burden should be relieved or carried by support staff:
<blockquote>"Sharing data costs a lot of time and is inefficient when you do not do it often"</blockquote>
<blockquote>"Minder acties die gericht zijn op inhoudelijk trainen van WP en meer uit handen nemen van deze groep."</blockquote>
- **Unclear expectations and support channels**: There is unclarity in the exact requirements for researchers: what does the process look like? Who should they ask for help, and with what kinds of questions?
<blockquote>"There is no one who tells at the start of your PhD how you should handle your data. [...] I think new PhD students should get a basic course on data management and privacy."</blockquote>
- **More hands-on support**: Some researchers find that support staff could sometimes provide support in a more hands-on fashion, rather than abstract advice and telling researchers how *not* to do things. Some researchers add that privacy professionals have a tendency to cling to the letter of the law, instead of looking at how to apply the GDPR in practice:
<blockquote>"I find that there is a severe lack of trust in employees"</blockquote>
<blockquote>"Soms zijn we door deze regels heiliger dan de paus."</blockquote>
- **Specific data types**: Many researchers express the need for practical guidelines, tools and templates, and on specific types of data (e.g., etnographic, historic, linguistic, video data, etc.) or in specific scenarios. Multiple researchers indicate that existing solutions are not always suitable for their type of research, or that there are no (standardised) guidelines available at all.
<blockquote>"De informatie is gewoon veel te generiek, er zouden templates moeten zijn per type onderzoek."</blockquote>
<blockquote>"Veel templates en uitlegmodellen spreken over data, data packages en metadata, maar die woorden zijn niet ingebed in historisch onderzoek. Er ontstaat al snel verwarring over wat historici nu precies moeten met archiefmateriaal in het licht van privacy."</blockquote>
- **Specific tools**: Some researchers express a need for a concrete (improvement of a) tool, such as for pseudonymising video data (n = 4), transcribing audio data (n = 4), and sharing data with others (n = 3). 


Importantly, there are also researchers who indicate **not** to have run into any issues or to have received sufficient and useful help:
<blockquote>"The data manager and privacy officer of the faculty of humanities help a lot. This support is essential!"</blockquote>
<blockquote>"Tot nu toe heb ik niet veel problemen gehad. De institutional review board van onze afdeling kijkt altijd kritisch naar de onderzoeksvoorstellen, ook met name op omgaan met persoonsgegevens."</blockquote>

ALSO INTERESTING
"actual getting your hands dirty support. not the kind that tells you what to do, but also the kind that helps you by doing.

"i find a lot of challenges because it's the first time i'm including personal data. but the data manager and privacy officer of the faculty of humanities help a lot. this support is essential!"

"vooral meer gecentraliseerd. uu biedt ontzettend veel aan maar je moet veel websites bezoeken om alles te vinden en zoeken op de uu website is waardeloos (ik google vaak en kom dan bij relevante uu sites uit). een duidelijk overzicht voor welke informatie je waar moet zijn zou fijn zijn. nu teveel versnipperd."

### Faculty-specific
asdfadf

## {-}

## Challenges and needs (meetings)

As the one-on-one meetings are currently conducted, a summary or the results will be added at a later time.


# Results summary [preliminary]

In this survey, we find that personal data are processed in each faculty and 
across all academic positions at Utrecht University. Most researchers have 
tabular, textual, code and audiovisual datasets, which contain all kinds of 
personal data (mostly demographics, contact information, direct identifiers).
  
Most researchers are familiar with concepts like anonymisation and 
pseudonymisation, access control, and UU-approved tools for handling personal 
data. However, the knowledge level differs quite a bit. For example, some 
researchers seem to store data on locations that officially are not allowed.
Data is often shared, but not all the right measures are always taken to do so 
securely. Additionally, some measures to securely handle personal data in accordance 
with the GDPR are less known, or there is confusion about it. For example, 
the processing register, Data Protection Impact Assessment, and Standard 
Contractual Clauses are among the least known concepts that we measured. And there
seems to be unclarity among part of the respondents on when sharing data is allowed
or when data are personal. Together, this suggests that there is a lot to be gained
regarding awareness and secure practices in scientific research with personal data.

Below, we summarise challenges and needs explicated by researchers. 

# Recommendations [preliminary]
## Increased visibility

Our data show that the visibility of existing support for handling personal data 
can be increased at UU. This includes visibility of privacy officers, legal affairs 
and Research Data Management Support, as well as faculty- or department-level 
support. 

As shown by the fact that many respondents consult with colleagues for 
information and support, personal contact with supporters will likely be more 
effective at increasing awareness and uptake of secure privacy practices than a 
passive website that may not always answer all possible questions.

Some suggestions for increasing visibility:

- Make sure there is (sufficient) support available to help researchers in time.
If there is no support available, the odds are that researchers may not ask for 
help at all and thus forget important privacy elements in the design of their 
research project.
- Make sure support staff are easy to find. For example, give them a clear location
on the university website and/or on the intranet. Also indicate who is available
for what type of support and for which target audience (e.g., "all UU 
researchers", "employees from the Faculty of Humanities", etc.)
- Make sure information on handling personal data in research is easy to find.
The UU website and intranet seem the most suitable places, as these are the most
visited to look for information according to the survey. 
- Make researchers actively aware of existing support channels. For example,
first-line support can visit important faculty or department events, offer to
give a workshop, and keep short lines of contact with department heads.

## More hands-on support

The survey and interviews show that some researchers are not content with the 
support they have received in the past. For example, their research project may
have suffered significant delays due to the fact that support personnel only
pointed them at what they could *not* do, rather than how to solve privacy-
related issues. We noticed many researchers that argue for more hands-on suppport,
rather than advise with no concrete direction how to apply it in practice. More
hands-on support can for example be reached by:

- More collaboration between different types of data support. For example, at UU
there is a clear distinction between privacy officers (employed by faculties),
data managers (employed by the University Library and some faculties), information
security officers (Information Technology Services) and research engineers 
(Information Technology Services). However, in practice there is often overlap 
between either or all of these positions. Regular collaboration between these 
parties can:
  - help privacy and security experts understand the perspective of the 
  researcher and possibly how to apply their advice in practice,
  - help data managers and research engineers understand the GDPR requirements 
  and translate those to practice, and
  - enable reuse of solutions already applied in earlier cases that either 
  party may not be aware of.
- Together with researchers, developing suitable practical solutions (tools, 
protocols, etc.) for specific scenarios and/or types of research, and sharing 
them with the world for reuse (if possible).
- Increasing contact between support staff and researchers to understand the 
issues they are dealing with that require a solution.

## Decreased administrative burden

A selection of researchers mention a high administrative burden when handling
personal data. This is for example expressed in processes that take too long
(e.g., writing and reviewing a Data Privacy Impact Assessment) and too many 
forms to be filled out with overlapping content (e.g., privacy review, Data 
Management Plan, processing register, DPIA). We suggest that these issues can 
be partly attributed to:

1. Understaffing: it is currently impossible for data support staff to review 
all research projects involving personal data that are undertaken at UU. This 
can lead to projects with issues being noticed too late and researchers having 
to change their timeline or even project as a whole after the fact. This creates
unnecessary administrative burden that could have been prevented had researchers
been in contact with support staff. 
2. Lack of unifying policy on steps to take when working with personal data. At
the moment each faculty has its own procedure, or has none at all. This can 
create confusion among both researchers and support staff on which steps to take
when, who to contact for help, or who is responsible for deciding on compliance.
3. Lack of integration between systems and staff: having to fill out the same
thing multiple times may be caused by the fact that different administrative
systems are used for different purposes. Integration of these systems may lead
to a relief of the administrative burden experienced by researchers. <br>For 
example, DMPonline is used at UU for registering Data Management Plans. However, 
DMP templates do not include sufficient questions about how personal data are 
handled, and thus a privacy plan or review may be required. Privacy is 
sometimes part of an ethical application, and so this same information may be 
included there again as well. Finally, the processing register also requires 
information on (among others) the type and sensitivity of personal data, 
which is a third system where this information will be registered.

## Education and outreach

Many problems seem to arise from the fact that privacy has not been taken into
account from the design phase of a research project. This leads to research
support staff being contacted too late in the process, who then has to tell the
researcher to retrospectively make changes in their design in order to move 
forward. 

Such scenarios may be prevented by, for example:

- Including the basic of handling personal data and contact details of support
staff in onboarding processes when researchers are newly hired.
- Educating researchers on taking privacy into account in the designing phase
of their project. 
- Organising outreach events, such as the "Privacy and Security week" making
researchers aware of privacy-related measures (see further Visibility).
- Embedding privacy in existing materials and processes, such as in ethical
applications, in the education of research master and PhD students, etc.

# Discussion

This report summarised the findings of the Data Privacy Survey and our recommendations on what to do with the input we have received. In order to interpret these results correctly, there are a few matters that need to be taken into account:

1. The respondents of the survey represented only a small selection of all of UU's Scientific Personnel. Therefore, the results presented here should not be overgeneralized to represent all of UU's researchers. It is likely that at least part of the respondents had a specific reason to do so. For example, they may have explicitly wanted to raise their voice because of some bad experiences in handling personal data in research. Although it is important that these concerns be heard, they should not be interpreted as to speak for all UU researchers.   
2. It is important to note that we, the writers of this report, cannot be considered fully objective in interpreting the survey results. The feedback received via this survey also involves our own services and possibly work performance. Although we have attempted to interpret the results of the survey without bias, it is possible that we have indeed introduced some, especially where the open questions and one-on-one meetings are concerned.   
3. The questions in this survey intentionally do not address at which data support personnel the feedback is targeted. This also means that our recommendations do not specify Who within the organisation should pick them up. Preferably, these recommendations will be picked up by a  collaboration between data support at different levels of the organisation (departmental, faculty, central) and, if needed, beyond, to address researchers' concerns and improve the support surrounding the handling of personal data in research.

# Technical information
This document was last created on: `r as.character(Sys.Date())`.

```{r sessioninfo}
sessionInfo()
```
